const express = require('express'),
      bodyParser = require('body-parser'),
      morgan = require('morgan'),
      passport = require('passport'),
      jwt = require('jsonwebtoken'),
      config = require('./config/main');
      database = require('./database');	
      mongoose = require('mongoose');
           

//MongoDB stuff
mongoose.connect('mongodb://localhost:27017/test');
var db = mongoose.connection;
db.on('error', console.error.bind(console, 'connection error: '));
db.once('open', function(){
console.log(db);
});

//Import the User model
var User = require('./mongo').User;

var app = express();

app.set('port', process.env.PORT || 3000);

app.get('/', function(req, res){
   res.send("Hi!");
   console.log('REST API');
});

app.post('/registration', function(req, res){
   console.log(req.body.name);
   console.log(req.body.password);
   
   //Search if user name already exists in MongoDB
   User.findOne({ 'name': req.body.name}, function(err, 
   var newUser = new User({name: req.body.name, password: req.body.password});
   

});

app.post('/login', function(req, res){
  //Query DB for user
});



/*
var connection = mysql.createConnection({
   host    : 'localhost',
   user    : 'production',
   password : 'adultfriendlocator',
   database  : 'production_database'
});

connection.connect(function(err){
   if(err){
     console.error('Error connection: ' + err.stack);
     return;
   }
   console.log('connected as id ' + connection.threadId);
});
*/

app.listen(app.get('port'), function(){
   console.log('Express started on http://localhost:' + 
   app.get('port') + '; press Ctrl-C to terminate.');
});
